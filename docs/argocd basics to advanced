# ArgoCD Mastery: From GitOps Basics to Advanced Deployments

ArgoCD is a powerful GitOps continuous delivery tool for Kubernetes. It enables declarative deployments, progressive delivery, multi-cluster management, and automated rollbacks, making it a cornerstone of modern cloud-native workflows. 

---

## 1Ô∏è‚É£ Introduction to GitOps

GitOps is a paradigm where Git is the single source of truth for your infrastructure and applications. 

### Core Principles

| Principle          | Description                                      |
|--------------------|--------------------------------------------------|
| Declarative Configs| Store manifests (YAML/Helm/Kustomize) in Git     |
| Automated Sync     | Git changes are automatically applied to cluster |
| Observability      | Monitor cluster state vs Git repository          |
| Rollbacks          | Revert changes via Git commits                   | 

### Benefits

- ‚úÖ Version-controlled deployments  
- ‚úÖ Auditable changes  
- ‚úÖ Faster and safer rollbacks 

Official docs: GitOps Principles. 

---

## 2Ô∏è‚É£ ArgoCD Architecture

ArgoCD consists of control-plane and Kubernetes-native components. 

| Component        | Description                                     |
|------------------|-------------------------------------------------|
| API Server       | Central management API and UI                   |
| Controller       | Compares Git state with cluster state           |
| Repository Server| Accesses Git repositories                       |
| Application CRD  | Declarative representation of applications      |
| Dex (Optional)   | SSO integration for authentication              | 

---

## 3Ô∏è‚É£ Installing ArgoCD

```bash
# Install in the argocd namespace
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

# Access ArgoCD server (port-forward)
kubectl port-forward svc/argocd-server -n argocd 8080:443
``` 

### Login

```bash
# Get initial admin password
kubectl -n argocd get secret argocd-initial-admin-secret \
  -o jsonpath="{.data.password}" | base64 -d

argocd login localhost:8080 \
  --username admin \
  --password <password>
``` 

---

## 4Ô∏è‚É£ Creating Applications in ArgoCD

Applications in ArgoCD represent a Git repository and a target cluster/namespace. 

### CLI Example

```bash
argocd app create web-app \
  --repo https://github.com/myorg/web-app.git \
  --path manifests \
  --dest-server https://kubernetes.default.svc \
  --dest-namespace dev \
  --sync-policy automated
``` 

### CRD Example (kubectl)

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: web-app
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/myorg/web-app.git
    path: manifests
    targetRevision: HEAD
  destination:
    server: https://kubernetes.default.svc
    namespace: dev
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
``` 

---

## 5Ô∏è‚É£ App of Apps Pattern

Organize multiple applications hierarchically using a parent Application that deploys child Applications via Application CRDs. 

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: parent-app
  namespace: argocd
spec:
  source:
    repoURL: https://github.com/myorg/apps.git
    path: parent
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
``` 

‚úÖ Helps manage microservice ecosystems. 

---

## 6Ô∏è‚É£ Helm Integration with ArgoCD

ArgoCD natively supports Helm charts as a source. 

```yaml
spec:
  source:
    repoURL: https://github.com/myorg/helm-charts.git
    chart: web-app
    targetRevision: 1.0.0
``` 

‚úÖ Use for templated deployments and versioned releases. 

---

## 7Ô∏è‚É£ Kustomize Integration

ArgoCD supports Kustomize overlays for environment-specific configuration. 

```yaml
spec:
  source:
    repoURL: https://github.com/myorg/kustomize-app.git
    path: overlays/dev
``` 

‚úÖ Ideal for environment-specific configurations. 

---

## 8Ô∏è‚É£ ApplicationSets

ApplicationSets allow dynamic creation of multiple Applications from a single template. 

```yaml
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: web-app-set
spec:
  generators:
    - list:
        elements:
          - cluster: cluster1
            namespace: dev
          - cluster: cluster2
            namespace: prod
  template:
    metadata:
      name: '{{cluster}}-web-app'
    spec:
      project: default
      source:
        repoURL: https://github.com/myorg/web-app.git
        path: manifests
      destination:
        server: '{{cluster}}'
        namespace: '{{namespace}}'
``` 

‚úÖ Automates multi-cluster deployments. 

---

## 9Ô∏è‚É£ Sync Policies & Strategies

| Strategy   | Description                               |
|-----------|-------------------------------------------|
| Automated | Syncs Git changes automatically           |
| Manual    | Requires manual approval                  |
| Prune     | Deletes resources removed from Git        |
| Self-Heal | Restores drifted resources to Git state   | 

---

## üîü Progressive Delivery with ArgoCD Rollouts

Integrates with Argo Rollouts for canary and blue-green strategies and supports metric-based promotion. 

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: web-app-rollout
spec:
  strategy:
    canary:
      steps:
        - setWeight: 10
        - pause: { duration: 5m }
        - setWeight: 50
        - pause: { duration: 10m }
``` 

‚úÖ Enables controlled deployments with metrics-based automation. 

---

## 1Ô∏è‚É£1Ô∏è‚É£ Multi-cluster Management

ArgoCD can manage multiple clusters from a single control plane. 

```bash
argocd cluster add <context-name>
``` 

‚úÖ Centralized GitOps for multi-region or multi-cloud clusters. 

---

## 1Ô∏è‚É£2Ô∏è‚É£ ArgoCD Security & RBAC

- Supports SSO, OAuth, LDAP, and OIDC.  
- RBAC rules define who can manage which applications. 

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: argocd
  name: app-manager
rules:
  - apiGroups: ["argoproj.io"]
    resources: ["applications"]
    verbs: ["get", "create", "update", "delete"]
``` 

‚úÖ Enforce least privilege principle. 

---

## 1Ô∏è‚É£3Ô∏è‚É£ ArgoCD Notifications & Webhooks

Trigger notifications on sync success/failure, rollbacks, or health changes, and integrate with Slack, Teams, email, or custom webhooks. 

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Notification
metadata:
  name: web-app-notify
spec:
  template: slack
  triggers:
    - on-sync-succeeded
``` 

---

## 1Ô∏è‚É£4Ô∏è‚É£ ArgoCD Best Practices

- ‚úÖ Use Git as the single source of truth.  
- ‚úÖ Enable automated sync for low-risk apps.  
- ‚úÖ Use ApplicationSets for multi-cluster or microservice management.  
- ‚úÖ Integrate with Helm/Kustomize for flexible deployments.  
- ‚úÖ Monitor ArgoCD metrics and logs for drift and failures. 

---

## Interview Questions

**Q:** What is the App of Apps pattern in ArgoCD?  
**A:** A parent Application manages multiple child Applications for hierarchical deployment. 

**Q:** How do you implement progressive delivery with ArgoCD?  
**A:** Use Argo Rollouts with canary or blue-green strategies plus metric-based promotion. 

**Q:** Difference between manual and automated sync policies?  
**A:** Manual sync requires explicit approval to deploy changes; automated sync continuously applies changes from Git. 

**Q:** How does ArgoCD integrate with Helm and Kustomize?  
**A:** Helm charts or Kustomize overlays are referenced as sources in Application CRDs, allowing templated deployments and environment overlays. 

Official docs: ArgoCD Documentation. 
